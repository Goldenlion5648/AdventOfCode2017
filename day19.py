a='''                                                                                                                                                                                               |         
 +-------------+                                                         +---------------------------------------------------------------------------------------------------------------------|-+       
 |             |                                                         |                                                                                                                     | |       
 +-+ +---------+ +-----------------------------------------+         +-----------------------------------------------------------------+ +-------------------------------------+               | | +---+ 
   | |           |                                         |         |   |                                                             | |                                     |               | | |   | 
 +---+     +-----|-+                                       |       +-----+           +-----+                 +-----+ +---------------+ | +-------------------------------------|---+           | | +-+ | 
 | |       |     | |                                       |       | |               |     |                 |     | |               | |                                       |   |           | |   | | 
 | |   +-------+ +-|-------+                               |       | |               |     |                 |     | |               | |           +---------+     +-----------|---+           | |   | | 
 | |   |   |   |   |       |                               |       | |               |     |                 |     | |               | |           |         |     |           |               | |   | | 
 | |   |   |   |   |       |                               |       | |               |     |             +---------+ |               +-|-----------|-------------------------------------+   +-|-|-+ | | 
 | |   |   |   |   |       |                               |       | |               |     |             |   |       |                 |           |         |     |           |         |   | | | | | | 
 | |   |   |   |   |       |                               |       | |               |     |             |   |       |                 |           |         |     |         +-|-----+ +-----|-----|-+ | 
 | |   |   |   |   |       |                               |       | |               |     |             |   |       |                 |           |         |     |         | |     | | |   | | | |   | 
 | |   |   | +-+ +---------|---------------------------------------|-|---------------|-----------------------|---+   |                 |           |         | +---|---------|---------+ |   | | | |   | 
 | |   |   | |   | |       |                               |       | |               |     |             |   |   |   |                 |           |         | |   |         | |     |   |   | | | |   | 
 | |   |   | |   | |   +-------------------------------------------------------------------------------------|-------|-----------------|---------------------|-|---|---------|-------|-----+ +-|-|-|-+ | 
 | |   |   | |   | |   |   |                               |       | |               |     |             |   |   |   |                 |           |         | |   |         | |     |   | |   | | | | | 
 | | +---+ | |   | | +---------------------------------------------|-----------------|-----|-----------------|---|---------------------|-----------------------+   |         +-----------|---------|-+ | 
 | | | | | | |   | | | |   |                               |       | |               |     |             |   |   |   |                 |           |         |     |           |     |   | |   | | |   | 
 | | | | | | |   | | | |   |                               |       | |               |     |             |   |   |   |                 |           |         |     |           |   +---+ | |   | | |   | 
 | | | | | | |   | | | |   |                               |       | |               |     |             |   |   |   |                 |           |         |     |           |   | | | | |   | | |   | 
 | | | | | | |   | +-|-----|-------------------------------------+ | |               |     +-------------------------|-----------------|-+   +---+ +-------------------------+ |   | | | | |   | | |   | 
 | | | | | | |   |   | |   |                               |     | | |               |                   |   |   |   |                 | |   |   |           |     |         | |   | | | | |   | | |   | 
 | | | | | | |   |   +-|-----------------------------------------|-|-----------------|X--------------------------|---------------------|-|---|-----+         |     |         +-|---|-|-|-|---------+   | 
 | | | | | | |   |     |   |                               |     | | |               |                   |   |   |   |                 | |   |   | |         |     |           |   | | | | |   | |     | 
 | | | | | | |   |     |   |                 +-------------------|-|-----------+     |                   |   |   |   |                 | |   |   | |         |     |         +-----|-|-----|---|---+   | 
 | | | | | | |   |     |   |                 |             |     | | |         |     |                   |   |   |   |                 | |   |   | |         |     |         | |   | | | | |   | | |   | 
 | | | | | | |   |     |   |                 |             |     | | |         |     |                   |   |   |   |   +-------------|-----|---|-----------|-----|---------|---------+ | |   | | |   | 
 | | | | | | |   |     |   |                 |             |     | | |         |     |                   |   |   |   |   |             | |   |   | |         |     |         | |   | |   | |   | | |   | 
 | | | | | | |   +-+   |   |         +---------------------------|-|-|---------|-----|-----------------------|---|-------------------+ | |   |   | |         |     |         | |   | |   | |   | | |   | 
 | | | | | | |     |   |   |         |       |             |     | | |         |     |                   |   |   |   |   |           | | |   |   | |         |     |         | |   | |   | |   | | |   | 
 | | | | | | | H +-----|---|-----------------|-------------------|-|---------+ |     |                   |   |   |   |   |           | | |   |   +-----------|-----------------|---+ |   | |   | | |   | 
 | | | | | | | | | |   |   |         |       |             |     | | |       | |     |                   |   |   |   |   |           | | |   |     |         |     |         | |     |   | |   | | |   | 
 | | | | | | | | +-|---|---|---------------+ |             |     | | |       | |     +-------------------|-------|---------------------|-----|---------------|-----------+ +---------|-+ | |   | | |   | 
 | | | | | | | |   |   |   |         |     | |             |     | | |       | |                         |   |   |   |   |           | | |   |     |         |     |     | | | |     | | | |   | | |   | 
 +---+ | | | | +-+ |   |   |         |     | |             |     | | |       | |                         |   |   |   |   |           | | |   |     |         |     |     | | | |     | | | |   | | |   | 
   |   | | | |   | |   |   |         |     | |             |     | | |       | |                         |   |   |   |   |           | | |   |     |         |     |     | | | |     | | | |   | | |   | 
 +-|-----|-|-----|-|-----------------------|---------------------|---|-------|-|-----------------------------|---+   |   |           | | |   |     |         |     |     | | | |     +---|-----|-|-|---+ 
 | |   | | | |   | |   |   |         |     | |             |     | | |       | |                         |   |       |   |           | | |   |     |         |     |     | | | |       | | |   | | |     
 | |   | | | | +---|---|---|---------------|-----------------------|-------+ +-------------------------+ |   |   +---|---------------|-------|---------------|-----|---+ | | | |       | | |   | | |     
 | |   | | | | | | |   |   |         |     | |             |     | | |     |   |                       | |   |   |   |   |           | | |   |     |         |     |   | | | | |       | | |   | | |     
 +-------|---|---|-|-+ |   |         |     | +-------------|----I|---|---------|-----------------------|-|---|---|---|---|-------------------------|-------------------|---|-|-------------+   | | |     
   |   | | | | | | | | |   |         |     |               |     | | |     |   |                       | |   |   |   |   |           | | |   |     |         |     |   | | | | |       | |     | | |     
   |   | | +-|-----|---+   |         |     |               |     | | +---------|---+                   | |   |   |   |   |     +-------|-----|---------+     |     |   | | | | |       | |     | | |     
   |   | |   | | | | |     |         |     |               |     | |       |   |   |                   | |   |   |   |   |     |     | | |   |     |   |     |     |   | | | | |       | |     | | |     
   |   | | +-----+ +---------------------------------------------|---------+   |   |                   | |   |   |   |   | +-------+ | | |   |     |   |     +-----|---+ | | | |       | |     | | |     
   |   | | | | |     |     |         |     |               |     | |           |   |                   | |   |   |   |   | |   |   | | | |   |     |   |           |     | | | |       | |     | | |     
   |   +-|-|-|-|-+   |     |         |     |               |     | |           +-----+                 | |   |   |   | +-|-----|-------|---------------|-----------------------|---------|-----|-|-+     
   |     | | | | |   |     |         |     |               |     | |               | |                 | |   |   |   | | | |   |   | | | |   |     |   |           |     | | | |       | |     | |       
   |     | | | +-+ +-+     |         |     |               | +---|-|-----------------+                 | |   |   |   | | | |   |   | | | |   |     |   |           | +---------|-------|-+     | |       
   |     | | |     |       |         |     |               | |   | |               |                   | |   |   |   | | | |   |   | | | |   |     |   |           | |   | | | |       |       | |       
   | +-------|-----|-------|-+       |     |               | |   | |           +---------+             | |   |   |   | | | |   |   | | | |   |     |   |           | |   | | | |       |       | |       
   | |   | | |     |       | |       |     |               | |   | |           |   |     |             | |   |   |   | | | |   |   | | | |   |     |   |           | |   | | | |       |       | |       
   | |   | | |     |       | |       |     |               | |   | |           |   |     |             | |   |   |   | | | |   |   | | | |   |     | +-|-----------|-|---|---|-------+ |       +---+     
   | |   | | |     |       | |       |     |               | |   | |           |   |     |             | |   |   |   | | | |   |   | | | |   |     | | |           | |   | | | |     | |         | |     
   | |   | | |   +-|-------|-|-----------------------------|---------------+   |   |     |             | |   |   |   | | | |   |   | | | |   |     | | |           | |   | | | |     | |         | |     
   | |   | | |   | |       | |       |     |               | |   | |       |   |   |     |             | |   |   |   | | | |   |   | | | |   |     | | |           | |   | | | |     | |         | |     
   | +-------|---|---------|---------|-------------------------------------|---------------------------|-----|-------|-|-|-----|---|-|-|-|-+ +-------------------+ | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |             | |   |   |   | | | |   |   | | | | |       | | |         | | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |             | |   |   |   | | | |   |   | | | | |       | | |         | | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |             | |   |   |   | | | |   |   | | | | |       | | |         | | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |             +-|---|---|-----|-|-|---|---|-|-|-|-+       | | |         | | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |               |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
   | +-+ | +-----------------------+ |     |               | |   | |       |   |   |     |               |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
   | | | |   |   | |       | |     | |     |               | |   | |       |   |   |     |               |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
 +-----|---+ |   | +-------|-------|-------|-----------------|---|-|---------------------+               |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
 | | | | | | |   |         | |     | |     |               | |   | |       |   |   |                     |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
 | | | | | | |   |     +---|---------------|-----------------|-----|-----------|---------+               |   |   |   | | | |   |   | | | | +-------|-|-----+     | | |   | | | |     | |         | |     
 | | | | | | |   |     |   | |     | |     |               | |   | |       |   |   |     |               |   |   |   | | | |   |   | | | | |       | | |   |     | | |   | | | |     | |         | |     
 | | | | | | |   |     |   | +-------|-----------------------|-----|---------------|-----|-------------------|-----------+ |   |   | | | | |       | | |   |     | | +---|-+ | |     | |       +-|-----+ 
 | | | | | | |   |     |   |       | |     |               | |   | |       |   |   |     |               |   |   |   | |   |   |   | | | | |       | | |   |     | |     |   | |     | |       | | |   | 
 | | | | +-|-|---------+   +-+     | |     |               | |   | |     +-|---|---|---------------+     |   |   |   | |   |   |   | | | | |       | | |   |     | |     |   | |     | | +---------|-+ | 
 | | | |   | |   |           |     | |     |               | |   | |     | |   |   |     |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |     |   | |     | | |     | | | | | 
 | | | | +-------+         +---------|-----------+         | |   | |     | |   |   +---------------|-------------------|---|---|---|-|-|-----------|-|-|---------|-|---+ |   | |     | | |     | | | | | 
 | | | | | | |             | |     | |     |     |         | |   | |     | |   |         |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |   | |   | |     | | |     | | | | | 
 | | | | | | |             | |     | |     |     |         | |   | |     | |   |         |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |   | |   | |     | | |     | | | | | 
 | | | | | | |             | |     | |     |     |         | |   | |     | |   |         |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |   | |   | |     | | |     | | | | | 
 | | | | | | |         +-----|-----|-|---------------------|-----|-------|-----------------------------------|---|---|-|-----------|-|-|-|-------------|-----------|---|-----|-----+ +-------+ | | | | | 
 | | | | | | |         |   | |     | |     |     |         | |   | |     | |   |         |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |   | |   | |   |   | |   | | | | | | 
 | | | | | | |         |   | | +---|-------|-----|---------------|---------+   |         |         |     |   |   +---|-------------|-----|---------|-------|-----+ |   | |   | |   |   | |   | | | | | | 
 | | | | | | |         |   | | |   | |     |     |         | |   | |     |     |         |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | | | | | 
 | | | | | | | +-+     |   | +-|-----------|---------------|-|---|-|-----|-------------------------------|---|---------|-----------|-|-|-|-|-----------|---------------|-|---|-----------|---------|-+ | 
 | | | | | | | | |     |   |   |   | |     |     |         | |   | |     |     |         |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | | |   | 
 | | | | | | | | |     | +-----|-----|-----|-----+         | |   | |     |     |         |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | | |   | 
 | | | | | | | | |     | | |   |   | |     |               | |   | |     |     |         |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | | |   | 
 | +-|---|-|-|-|---------------------------|-----------------|-----|-----|-----------+   |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | +-|-+ | 
 |   | | | | | | |     | | |   |   | |     |               | |   | |     |     |     |   |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | |   | | | 
 +---|-----|---|-------+ | |   | +-----+   |               | |   | |     |     |     |   |         |     |   |       | |   |   |   | | | | +-------|---|---|-----------|-------|-----+ | |   | |   | | | 
     | | | | | | |       | |   | | | | |   |               | |   | |     |     |     |   |         |     |   |       | |   |   |   | | | |         | | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | |       | |   | | | | |   |               | |   | |     |     |     |   |         |     |   |       | | +-----|---------|---------+ | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | |       | |   | | | | |   |               | |   | |     |     |     |   |         |     |   |       | | | |   |   | | | |           | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | | +-----|-----|---|-|-|---------------------|-----------------------|---|---------|---------|-------|-----|-------|-|-|---------+   | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | | |     | |   | | | | |   |               | |   | |     |     |     |   |         |     |   |       | | | |   |   | | | |       |   | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | | |     | |   | | | | | +---+             | |   | |     |     |     |   |         |     |   |       | | | |   |   | | | |       |   | |   |       |   | |   | +---------+   | |   | | | 
     | | | | | | | |     | |   | | | | | | | |             | |   | |     |     |     |   |         |     |   |       | | | |   |   | | | |       |   | |   |       |   | |   |     | | |     | |   | | | 
     | +-|---|-|---------|-----|---|-|---+ | |             | |   | |     |     |     | +-----------+     |   |       | | | |   |   | | | |       |   | +-----------------|---|-+   | +-|---+ | |   | | | 
     |   | | | | | |     | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | +-|-------+ +---+ | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       +-|-|-|---|---|-|-|-------------|-----+       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |         | | |   |   | | | |       |   |             |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |         | | +---+   | | | |       |   |             |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   | |   | |   |   |   | | |   | | | 
 +---|-------|---------+ +-----|-|-|---|---|-|---+         | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   | +-+ | |   |   |   | | |   | | | 
 |   | | | | | |           |   | | | | |   | |   |         | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   |   | | |   |   |   | | |   | | | 
 |   | +-|-----------+     |   | | | | |   | |   |         | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   |   | | +-------|-----|-|-------+ 
 |   |   | | | |     |     |   | | | | |   | |   |         | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   |   | |     |   |   | | |   | |   
 |   |   | | | |     |     |   | | | | |   | |   |         | |   | |     |     |     | | |   +---------------------------|---------|---|-------------|-----------------|-+ | |     |   |   | | | +-|-|-+ 
 |   |   | | | |     |     |   | | | | |   | |   |         | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |     |   |   | | | | | | | 
 |   | +---|---|-+   |     |   | | | | |   | |   |       +-------|-|-----|-----|---------------------------------------|-|-----------|-|---------|---|--N----------------|---------|---------|-----|---+ 
 |   | | | | | | |   |     |   | | | | |   | |   |       | | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |     |   |   | | | | | |   
 |   | | | | | | |   |     | +---|---------|-|-----------|---------|-----|-----------|-|-----|-----------|-------------|-|---------|-------------|---------------------|---|-|---+ |   |   | | | | | |   
 |   | | | | | | |   |     | | | | | | |   | |   |       | | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |   | |   |   | | | | | |   
 +-------+ | | | |   |     | | | | | | |   | |   |       | | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |   | |   |   | | | | | |   
     | |   | | | |   |     | | | | | | |   | |   |       | | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |   | |   |   | | | | | |   
 +---|-+   | | | |   |     | | | | | | |   | |   |       +-------|-------------|-----|---|---|---------------|-----------|-------------|---------|---+             |   | | | |   | |   |   | | | | | |   
 |   |     | | | |   |     | | | | | | |   | |   |         | |   | |     |     |     | | |   |           |   |         | |         | | | |       |                 |   | | | |   | |   |   | | | | | |   
 | +-------|-----|---|-----|-|---------------|---------------|---|-------|-----------|---|-------------------|---------|-----------|-|-|-------------------------------------------|---|-------------|-+ 
 | | |     | | | |   |     | | | | | | |   | |   |         | |   | |     |     |     | | |   |           |   |         | |         | | | |       |                 |   | | | |   | |   |   | | | | | | | 
 | | |     | | | |   |   +-+ +-|-|-|---------|---|---------|-|-----|-----|-----+     | | |   |           |   |         | |         | | | |     +-----+             |   | | | |   | |   |   | | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |         | |   | |     |           | | |   |           |   |         | |         | | | |     | |   |             |   | | | |   | |   |   | | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |       +---|---|-|-------------------|-----|---------------|---------|-|---------------|-------|-----------------|-----|-|-|---|-|-------+ | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |       | | |   | |     |           | | |   |           |   |         | |         | | | |     | |   |             |   | | | |   | |   |     | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |       | | |   | |     |       +---+ | |   |           |   |         | |         | | | |     | |   |             |   | | | |   | |   |     | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |       | | |   | |     |       |     | |   |           |   |         | |         | | | |     | |   |             |   | | | |   | |   |     | | | | | | 
 | | |     | | | |   |   |     | | +-|-|---+ |   |       | | |   | |     |       |     | |   |           |   |         | |     +---|-|----Y------------------------|---|-|---|---+ |   |     | | | | | | 
 | | |     | | | |   |   |     | |   | |     |   |       | | |   | |     |       |     | |   |           |   |         | |     |   | | | |     | |   |             |   | | | |     |   |     | | | | | | 
 | | |     +-|-|-----|-----------|---|-------------------|-|-+   | |     |       |     | |   |           |   |         | |     +-----|-|-|---------------------------------|-------|---|-+   | | | | | | 
 | | |       | | |   |   |     | |   | |     |   |       | |     | |     |       |     | |   |           |   |         | |         | | | |     | |   |             |   | | | |     |   | |   | | | | | | 
 | | +---------|-|-------|-----------|-|-----|---|-------|---------|-----|-------|-------+   |           |   |         +-|-------+ | | | |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |         | | |   |   |     | |   | |     |   |       | |     | |     |       |     |     |           |   |           |       | | | | |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |         | | |   |   |     | |   | |     |   |       | +---+ | |     |       |     +-----------------|---------------|-----------|-|-|-----|-|---|-------------|---|-|-|-------|---------|-+ | | | | 
 | |         | | |   |   |     | |   | |     |   |       |     | | |     |       |           |           |   |           |       | | | | |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |     +-------|---|---------------|-------------------|-----+ | |     |       |     +-+   |           |   |         +---------|-|-|-+ |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |     |   | | |   |   |     | |   | |     |   |       |       | |     |       |     | |   |           |   |         | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |     |   | | |   |   |     | |   | |     |   |       |       | |     |       |     +-|---------------|---|-----+   | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |     |   | | |   |   |     | |   | |     |   |       |       | |     |       |       |   |           |   |     |   | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   +-|-----------|-----+   | |   | |     |   |       |       | |     |       |       |   |           |   |     |   | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   | |   | | |   |   | |   | |   | |     |   |       |       | |     |       |       |   |           |   |     |   | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   | |   | | |   |   | |   | |   | +-----------------|-------|-|-----|-------------------------------|---|-----|---|---------+ | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   | |   | | |   |   | |   | |   |       |   |       |       | |     |       |       |   |           |   |     |   | |         | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   | |   | | |   |   | |   | |   |     +-|---|-------|-------|-|-----------------------------------------------|---|-----------------|-------------------------|---------|---------|-|-----+ | | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |           |   |     |   | |         G |   |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |           +---|---------------------|-|-+ |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |         | | | |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |         | | | |     | |   +-----------------|-----------|---|-----|-|-+ | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |         | | | |     | |                 |   | | | |     |   | |   | |   | | | 
 | |   | |   | +-----|-+ | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |     +-+ | | | | +---------------------+ |   | | | |     |   | |   | |   | | | 
 | |   | |   |   |   | | | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |     | | | | | | |   | |               | |   | | | |     |   | |   | |   | | | 
 | |   | |   | +---------|-|---------------|-----------------------------|---------------|---|-------------------+ |   | |     | | | | | | | +-|-|-----------------|---|-|---------+   | +-----|-+ | | | 
 | |   | |   | | |   | | | |   | |   |     | |   |       |       | |     |       |       |   |               |   | |   | |     | | | | | | | | | |               | |   | | | |         |     | | | | | | 
 | |   | |   | | |   | | | |   | |   |     | |   |       |       | |     |       |       |   |               |   | +---|---------|-|-+ | | | | | |               | |   | | | |     +-----+   | | | | | | 
 | |   | |   | | |   | | | |   | |   |     | |   |       |       | |     |       |       |   |               |   |     | |     | | |   | | | | | |               | |   | | | |     |   | |   | | | | | | 
 | | +---------|-----|---|-+   | |   |     | |   |       |       | |     |       |       |   |               |   |     | |     | | |   | | | | | |               | |   | | | |     |   | +-----|-+ | | | 
 | | | | |   | | |   | | |     | |   |     | |   |       |       | |     |       |       |   |               |   |     | |     | | |   | | | | | |               | |   | | | |     |   |     | |   | | | 
 | | | | |   | | |   | | |     | |   |     | +-----------+       | |     |       |       |   |               |   |     +-|-+   | | |   | | | | | |               | |   | +-|-|-----|---|-+   | |   | | | 
 | | | | |   | | |   | | |     | |   |     |     |               | |     |       |       |   |               |   |       | |   | | |   | | | | | |               | |   |   | |     |   | |   | |   | | | 
 | | +---|-+ | | |   | | |     | |   |     +-----|-----------------------|---------------|-------------------------------|-|---|-------|-+ | +-|-|---------------|-|-------|-|---+ |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |               |   |       | |   | | |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |           +-------|---------------+ |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |           |   |   |       | |   |   |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |           |   |   |       | |   |   |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |           |   |   |       | |   |   |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               +---------------------------|---------------|---|-------|-|-----------|-------------------------|-|---------|-----|---|-----|-|-----+ | 
 | |   | | | | | |   | | |     | |   |           |                 |     |       |       |   |           |   |   |       | |   |   |   |   |   | |               | |   |   | |   | |   | |   | |   |   | 
 | |   | | | +-----+ | | | +---------|-------------------+         +-----+       |       |   |           |   |   |       | |   |   |   |   +--W|-|---------------|-|---|-------+ | +---|-+   | |   |   | 
 | |   | | |   | | | | | | |   | |   |           |       |                       |       |   |           |   |   |       | |   |   |   |       | |               | |   |   | | | |     |     | |   |   | 
 | |   | | |   | | | | | | |   | |   |           |       |         +-------------------------------------+   |   |       | |   |   |   |       | |               | |   |   | | | +-------+   | |   |   | 
 | |   | | |   | | | | | | |   | |   |           |       |         |             |       |   |               |   |       | |   |   |   |       | |               | |   |   | | |       | |   | |   |   | 
 | |   | | |   | | | | | | |   | |   | +-----+   |       |         +-------------|-------------------------------|---------|---|---------------|-|---------------|-|---+   +-+ |       | |   | |   |   | 
 | |   | | |   | | | | | | |   | |   | |     |   |       |                       |       |   |               |   |       | |   |   |   |       | |               | |           |       | |   | |   |   | 
 | |   | | |   | | +-------|---+ |   | +-------------+   |                   +-----------+   |               |   +---+   | +---|-+ |   |       | |               | |           |       | |   | |   |   | 
 | |   | | |   | |   | | | |     |   |       |   |   |   |                   |   |           |               |       |   |     | | |   |       | |               | |           |       | |   | |   |   | 
 +-|---|-|-|---|-----|-|-|-----------------------|---|---|-----------------------|-----------|-----------------------|---------|---|-----------|-|-----------------|---------+ |       | |   | |   |   | 
   |   | | |   | |   | | | |     |   |       |   |   |   |                   |   |           |               |       |   |     | | |   |       | |               | |         | |       | |   | |   |   | 
   | +-|---|---------------+ +-------------------|---+   |                   |   |           |               +-------|---|-----|-----------------|-----------------+         | |       | |   | |   |   | 
   | | | | |   | |   | | |   |   |   |       |   |       |                   |   |           |                       |   |     | | |   |       | |               |           | |       | |   | |   |   | 
   | | | | +---------|-----+ |   |   |       |   |       |                   |   |           |                       |   |     | | |   |       | |               |           | |       | |   | |   +---+ 
   | | | |     | |   | | | | |   |   |       |   |       |                   |   |           |                       |   |     | | |   |       | |               |           | |       | |   | |         
   | | +---+   | | +---+ +---|------K--------|-------------------------------|---------------|-----------------------|---|-------------|---------|---+           |           | |       | |   | |         
   | |   | |   | | | |     | |   |   |       |   |       |                   |   |           |                       |   |     | | |   |       | |   |           |           | |       | |   | |         
 +---|---|-+   +-|-----+ +-+ +-+ +---|-------------------------------------------|---------------------------------------------|---|-----------|-----|---------+ |   +-------|-+       | |   +---+       
 | | |   |       | | | | |     |     |       |   |       |                   |   |           |                       |   |     | | |   |       | |   |         | |   |       |         | |     | |       
 | +-|---|-------+ | | | |     |     |     +-|-----------|-------------------+   |           |               +-----------|-------|-|-------------+   |         | |   |       |         | +---+ | |       
 |   |   |         | | | |     |     |     | |   |       |                       |           |               |       |   |     | | |   |       |     |         | |   |       |         O     | | |       
 |   |   | +---------|-|-|-----------|-----|-|---|-------------------------------+           |               +-----------+     | +-|---|-------+ +---+         | |   |       |         |     | | |       
 |   |   | |       | | | |     |     |     | |   |       |                                   |                       |         |   |   |         |             | |   |       |         |     | | |       
 +---|---|-------+ | | | |   +-------|-------|-----------------------------------------------|-----------------------|-------------|---|---------+             +-------------|---------+     +---------+ 
     |   | |     | | | | |   | |     |     | |   |       |                                   |                       |         |   |   |                         |   |       |                 | |     | 
     |   | +-----|---|---------|-----|-----------------------------------------------------------------------------------------|---------------------------------+ +-+       |                 | |     | 
     |   |       | | | | |   | |     |     | |   |       |                                   |                       |         |   |   |                           |         |                 | |     | 
     |   |       | | | | +---|-+     | +-----|---|-------+                                   +-----------------------+         |   |   +---------------------------+         +---------------+ +-+     | 
     |   |       | | | |     |       | |   | |   |                                                                             |   |                                                         |         | 
     | +-+       +-+ | |     |       | |   +-+   |       +---------------------------------------------------------------------------------------------------------------------------------------------+ 
     | |             | |     |       | |         |       |                                                                     |   |                                                         |           
     +-+             +-+     +-------+ +---------+       +---------------------------------------------------------------------+   +---------------------------------------------------------+           
                                                                                                                                                                                                         '''
# a ='''     |          
#      |  +--+    
#      A  |  C    
#  F---|----E|--+ 
#      |  |  |  D 
#      +B-+  +--+ 
# '''

board = []
for i in a.split("\n"):
    board.append(list(i))
for i in board:
    print(i)

posX = 0
posY = 0
board.pop(-1)


for i in range(len(board[0])):
    if board[0][i] == "|":
        posX = i

cur = board[posY][posX]
letters = []
direction = 2
count = 0
steps = 1
shouldStop = False
while True:
    cur = board[posY][posX]
    if direction == 0:
        while cur != "+":
            #print(cur)
            if cur.isalpha():
                letters.append(cur)
                print(cur, "added")
            if "H" in letters:
                shouldStop = True
                break
            posY -= 1
            steps += 1
            print(steps)
            if posY < 0:
                shouldStop = True
                break
            cur = board[posY][posX]
    elif direction == 1:
        while cur != "+":
            #print(cur)
            if cur.isalpha():
                letters.append(cur)
                print(cur, "added")
            if "H" in letters:
                shouldStop = True
                break
            posX += 1
            steps += 1
            print(steps)


            cur = board[posY][posX]



    elif direction == 2:
        while cur != "+":
            #print(cur)
            if cur.isalpha():
                letters.append(cur)
                print(cur, "added")
            if "H" in letters:
                shouldStop = True
                break
            posY += 1
            steps += 1
            print(steps)
            cur = board[posY][posX]

    elif direction == 3:
        while cur != "+":
            #print(cur)
            if cur.isalpha():
                letters.append(cur)
                print(cur, "added")
            if "H" in letters:
                print("steps", steps)
                shouldStop = True
                break
            posX -= 1
            steps += 1
            print(steps)


            cur = board[posY][posX]
            if posX < 0:
                shouldStop = True
                break

    if shouldStop:
        break

    if "H" in letters:
        print("outside ", steps)
        shouldStop = True
        break
    # print(posX, posY)
    # print("cur tile", cur)
    if posX + 1 < len(board[0]) and board[posY][posX + 1] != " " and direction != 3:
        direction = 1
        posX += 1
    elif posX - 1 >= 0 and board[posY][posX - 1] != " " and direction != 1:
        direction = 3
        posX -= 1
    elif posY + 1 < len(board) and board[posY+ 1][posX] != " " and direction != 0:
        direction = 2
        posY += 1
    elif posY - 1 >= 0 and board[posY - 1][posX] != " " and direction != 2:
        direction = 0
        posY -= 1
    else:
        break
    steps += 1

    
    count +=1
    # print("dir", direction)
    if count == 3:
        # break
        pass
    if len(letters) != len(set(letters)):
        break
    print(letters)

print("".join(letters))
print(steps)
#GINOWKYXH
#part 1 done in 32:51
#part 2 done in 18:50, a few incorrect guesses lead to penalty time
